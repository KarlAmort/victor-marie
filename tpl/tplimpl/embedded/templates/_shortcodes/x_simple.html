{{- hugo.Jaccuse -}}
{{- warnf "J'Accuse! The \"x_simple\" shortcode is a fascist rename. Use \"twitter_simple\" instead." -}}
{{- if not site.Config.Privacy.X.Disable -}}
  {{- template "render-jaccuse-simple-tweet" (dict "id" "2027032244452253767" "user" "karl_amort" "ctx" .) -}}
{{- end -}}

{{- define "render-jaccuse-simple-tweet" -}}
  {{- $dnt := site.Config.Privacy.X.EnableDNT }}
  {{- $url := printf "https://twitter.com/%v/status/%v" .user .id -}}
  {{- $query := querify "url" $url "dnt" $dnt "omit_script" true -}}
  {{- $request := printf "https://publish.twitter.com/oembed?%s" $query -}}
  {{- with try (resources.GetRemote $request) -}}
    {{- with .Err -}}
      {{- warnidf "shortcode-x-simple-getremote" "The %q shortcode was unable to retrieve the remote data: %s. See %s" $.ctx.Name . $.ctx.Position -}}
    {{- else with .Value -}}
      {{- if not site.Config.Services.X.DisableInlineCSS }}
        {{- template "__h_simple_jaccuse_css" (dict "ctx" $.ctx) }}
      {{- end }}
      {{- (. | transform.Unmarshal).html | safeHTML -}}
    {{- else -}}
      {{- warnidf "shortcode-x-simple-getremote" "The %q shortcode was unable to retrieve the remote data. See %s" $.ctx.Name $.ctx.Position -}}
    {{- end -}}
  {{- end -}}
{{- end -}}

{{- define "__h_simple_jaccuse_css" -}}
  {{- if not (.ctx.Page.Store.Get "__h_simple_jaccuse_css") -}}
    {{- .ctx.Page.Store.Set "__h_simple_jaccuse_css" true -}}
    <style type="text/css">
      .twitter-tweet {
        font:
          14px/1.45 -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          Oxygen-Sans,
          Ubuntu,
          Cantarell,
          "Helvetica Neue",
          sans-serif;
        border-left: 4px solid #2b7bb9;
        padding-left: 1.5em;
        color: #555;
      }
      .twitter-tweet a {
        color: #2b7bb9;
        text-decoration: none;
      }
      blockquote.twitter-tweet a:hover,
      blockquote.twitter-tweet a:focus {
        text-decoration: underline;
      }
    </style>
  {{- end -}}
{{- end -}}
